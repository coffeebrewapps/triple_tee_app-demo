import{_ as z,t as A,u as I,j as q,k as F,r as p,c,o as H,d as m,e as k,n as M,A as L,y as P,i as s,f as _,q as h,P as W,H as Y,h as G,z as J,s as K}from"./index-66a5b31b.js";import{u as Q}from"./errors-ebd9927f.js";import{u as X}from"./utils-3e19fdef.js";import{T as Z}from"./TemplateEditor-7dc23eb6.js";import"./TabContainer-f2954ca9.js";const $={class:"page-container"},ee={class:"heading"},te={class:"name"},ae={key:1,class:"actions"},ne={__name:"NewTemplate",props:{disabled:{type:Boolean,default:!1}},setup(T){const S=A(),d=I(),E=Q(),{flashMessage:r}=q(),{initSampleData:C}=X(),v=F(),g=p({}),b=Object.assign({},S.currentRoute.value),l=c(()=>{if(a.value)return a.value.id}),f=c({get:()=>a.value.name,set:e=>{a.value.name=e}}),o=c(()=>b.params.templateType),V=c(()=>o.value==="invoice_templates"?"Create Invoice Template":"Create Receipt Template"),a=p({name:null,contentMarkup:null,contentStyles:null}),i=p(!1),u=p({});function w(e){return Object.entries(e).reduce((t,[n,U])=>(t[n]=U.map(O=>({name:O,params:{}})),t),{})}function y(e){return u.value[e]?u.value[e].map(t=>E[t.name](t.params)).join(", "):""}const N=c(()=>{const e={};return u.value.contentMarkup&&(e.contentMarkup=y("contentMarkup")),u.value.contentStyles&&(e.contentStyles=y("contentStyles")),e});async function D(e){if(!l.value){a.value.contentMarkup=e;return}const t=Object.assign({},a.value,{contentMarkup:e});await d.update(o.value,l.value,t).then(n=>{a.value=n,r("Updated markup successfully!")}).catch(n=>{v.error("Error updating markup",n),r("Error updating markup!")})}async function j(e){if(!l.value){a.value.contentStyles=e;return}const t=Object.assign({},a.value,{contentStyles:e});await d.update(o.value,l.value,t).then(n=>{a.value=n,r("Updated styles successfully!")}).catch(n=>{v.error("Error updating styles",n),r("Error updating styles!")})}function x(e){g.value=e}function B(){i.value=!i.value}async function R(){const e={name:a.value.name,contentMarkup:a.value.contentMarkup,contentStyles:a.value.contentStyles};await d.create(o.value,e).then(t=>{a.value=t,r("Template created successfully!")}).catch(t=>{r("Error creating template!"),u.value=w(t),v.error("Error creating template",t)})}return H(async()=>{g.value=C(o.value)}),(e,t)=>(m(),k("div",$,[M("h2",ee,[L(P(s(V))+" ",1),s(l)?_("",!0):(m(),k("i",{key:0,class:"fa-solid fa-circle-exclamation",onClick:B}))]),M("div",te,[h(s(Y),{modelValue:s(f),"onUpdate:modelValue":t[0]||(t[0]=n=>W(f)?f.value=n:null),label:"Template Name",size:"lg","error-message":y("name")},null,8,["modelValue","error-message"])]),a.value?(m(),G(Z,{key:0,id:a.value.id,"template-type":s(o),"content-markup":a.value.contentMarkup,"content-styles":a.value.contentStyles,data:g.value,disabled:T.disabled,"enable-generate":!1,"error-messages":s(N),onContentMarkupChange:D,onContentStylesChange:j,onDataChange:x},null,8,["id","template-type","content-markup","content-styles","data","disabled","error-messages"])):_("",!0),s(l)?_("",!0):(m(),k("div",ae,[h(s(J),{value:"Create Template",icon:"fa-solid fa-check",onClick:R})])),h(s(K),{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=n=>i.value=n),title:"Reminder",content:"You have not saved your template. Make sure to click on Create Template to submit the changes.",width:600,height:250},null,8,["modelValue"])]))}},ce=z(ne,[["__scopeId","data-v-71196fc2"]]);export{ce as default};

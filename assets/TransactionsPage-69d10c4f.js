import{D as $}from"./DataPage-b21f61a6.js";import{s as F,c as N,i as z,u as H,D as P,a as M,r as w,b as i,d as b,m as U,t as y,x as n,v as r,e as m,l as u,h as p,g as j,E as q,B as G}from"./index-affc3919.js";import"./input-4a95c407.js";import"./errors-ebd9927f.js";import"./DataForm-d1d7fb39.js";const J={class:"page-container"},K={key:0,class:"tag inline"},O={key:0},ae={__name:"TransactionsPage",setup(Q){const l=F().getSystemConfigs(),f=N(()=>l.includes.baseCurrencyId[l.baseCurrencyId]),{formatDate:g}=G(),{flashMessage:v}=z(),I=H(),S=P(),_=M(),x=[{type:"lg",transactionDate:"md"},{description:"lg"},{currencyId:"md",amount:"md",homeCurrencyAmount:"md"},{tags:"lg"},{associatedTransactionId:"lg"}];function d(e){return e.id}function D(e){return`${e.category}:${e.name}`}function h(e){const s=g(e.effectiveStart,l.timezone),t=g(e.effectiveEnd,l.timezone);let a=`${e.code}`;return a=a.concat(` (${s}`),t?a=a.concat(` - ${t})`):a=a.concat(" - present)"),a}function C(e){return e.description}const A=[{key:"id",type:"text",label:"ID",listable:!0,viewable:!1,creatable:!1,updatable:!1,sortable:!0},{key:"type",type:"enum",label:"Type",listable:!0,viewable:!0,creatable:!0,updatable:!1,filterable:!0},{key:"transactionDate",type:"date",label:"Transaction Date",listable:!0,viewable:!0,creatable:!0,updatable:!0,filterable:!0,sortable:!0},{key:"description",type:"text",label:"Description",listable:!0,viewable:!0,creatable:!0,updatable:!0},{key:"amount",type:"number",label:"Amount",listable:!0,viewable:!0,creatable:!0,updatable:!0},{key:"homeCurrencyAmount",type:"number",label:"Home Currency Amount",listable:!1,viewable:!0,creatable:!0,updatable:!0},{key:"tags",type:"multiSelect",label:"Tags",reference:{label:D},listable:!0,viewable:!0,creatable:!0,updatable:!0,filterable:!0,options:{server:!0,pagination:!0,modelClass:"tags",value:d,label:D}},{key:"currencyId",type:"singleSelect",label:"Currency",reference:{label:h},listable:!0,viewable:!0,creatable:!0,updatable:!0,filterable:!0,options:{server:!0,pagination:!0,modelClass:"currencies",value:d,label:h}},{key:"associatedTransactionId",type:"singleSelect",label:"Associated Transaction",reference:{label:C},listable:!0,viewable:!0,creatable:!0,updatable:!0,options:{server:!0,pagination:!0,modelClass:"transactions",value:d,label:C}}],R={initData:{type:null,currencyId:null,tags:[],transactionDate:{startDate:null,endDate:null}},layout:[{type:"md",currencyId:"md",tags:"md"},{transactionDate:"md"}]},E={row:{reverse:{name:"Reverse",icon:"fa-solid fa-rotate-left",click:async function(e,s){await B(e)}}}},V={oneline:!0,showHeader:!1,highlightField:"description"},o=w(),c=w(!1);async function B(e){o.value=e,c.value=!0}async function L(){await I.update("transactions",o.value.id,{},{path:"reverse"}).then(e=>{S.emitEvent("loadData",{dataType:"Transactions"}),v("Reversed transaction successfully!")}).catch(e=>{_.error("Error reversing transaction",e),v("Error reversing transaction!")}).finally(()=>{k()})}function k(){c.value=!1}return(e,s)=>(i(),b("div",J,[U($,{"model-class":"transactions","data-type":"Transactions",fullscreen:!0,"fields-layout":x,"data-fields":A,filters:R,actions:E,"table-style":V},{["highlight.description"]:y(({row:t,formattedValue:a})=>[n(r(a)+" ",1),t.associatedTransactionId?(i(),b("span",K,"Reversed")):m("",!0)]),["data-col.transactionDate"]:y(({formattedValue:t})=>[n(" Transacted on "),u("strong",null,r(t),1)]),["data-col.amount"]:y(({row:t,formattedValue:a,inputValue:T})=>[u("strong",null,r(T("type",t)),1),n(" amount "),u("strong",null,r(t.includes.currencyId[t.currencyId].code)+r(a),1),p(f).id!==t.currencyId?(i(),b("span",O,[n(" ("),u("strong",null,r(p(f).code)+r(T("homeCurrencyAmount",t)),1),n(") ")])):m("",!0)]),_:2},1024),o.value?(i(),j(p(q),{key:0,modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=t=>c.value=t),title:"Reverse Transaction","primary-text":"Are you sure you want to reverse this transaction?","secondary-text":o.value.description,width:500,height:350,class:"reverse-dialog",onConfirm:L,onCancel:k},null,8,["modelValue","secondary-text"])):m("",!0)]))}};export{ae as default};

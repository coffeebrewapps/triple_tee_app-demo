import{_ as b,u as w,a as E,r as p,c as B,o as T,b as o,d as i,e as d,F as A,f as L,g as _,h as m,C as O,T as S}from"./index-cb685be9.js";const D={class:"page-container"},P={key:0},H={key:1,class:"charts"},U={__name:"HomeView",setup(F){const y=w(),g=E(),l=p([]),f=p(getComputedStyle(document.documentElement).getPropertyValue("--color-text")),v=p(getComputedStyle(document.documentElement).getPropertyValue("--color-border")),C=B(()=>({highlightColor:f.value,lineColor:v.value}));g.registerListener("themeChange",{id:"RefreshChartColors",invoke:({newVal:a})=>{x()}});function x(){l.value.forEach(a=>{a.config.colors=C.value})}function u(a){return`${a[0].toUpperCase()}${a.slice(1)}`}async function V(){await y.list("chart_configs",{}).then(a=>{const s=a.data.sort((r,e)=>r.displayOrder<e.displayOrder?-1:r.displayOrder>e.displayOrder?1:0).map(r=>new Promise((e,n)=>{y.view("chart_configs",r.id,{},{path:"data"}).then(t=>{e({config:r,result:t})}).catch(t=>{n(t)})}));Promise.all(s).then(r=>{l.value=[],r.forEach(({config:e,result:n})=>{if(n.length===0)return;const t={title:e.description},h=[];e.chartType==="vbar"?(t.yScale=e.scaleValue,t.yAxisLabel=u(e.scaleUnit),t.xAxisLabel=u(e.groupBy),n.forEach(c=>{h.push({xValue:c.key,yValue:c.total})})):(t.xScale=e.scaleValue,t.xAxisLabel=u(e.scaleUnit),t.yAxisLabel=u(e.groupBy),n.forEach(c=>{h.push({yValue:c.key,xValue:c.total})})),l.value.push({chartType:e.chartType,config:t,data:h})})})}).catch(a=>{console.error(a)})}return T(async()=>{await V()}),(a,k)=>(o(),i("div",D,[l.value.length===0?(o(),i("div",P," No chart data. ")):d("",!0),l.value.length>0?(o(),i("div",H,[(o(!0),i(A,null,L(l.value,(s,r)=>(o(),i("div",{key:r,class:"chart"},[s.chartType==="vbar"&&s.data.length>0?(o(),_(m(O),{key:0,config:s.config,data:s.data},null,8,["config","data"])):d("",!0),s.chartType==="hbar"&&s.data.length>0?(o(),_(m(S),{key:1,config:s.config,data:s.data},null,8,["config","data"])):d("",!0)]))),128))])):d("",!0)]))}},$=b(U,[["__scopeId","data-v-d962cd50"]]);export{$ as default};

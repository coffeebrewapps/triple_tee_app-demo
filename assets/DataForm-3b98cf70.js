import{u as ge}from"./input-ddde269d.js";import{u as ye}from"./errors-ebd9927f.js";import{_ as Ve,k as he,r as w,c as v,o as ve,d as s,e as h,n as T,F as M,g as S,M as ke,J as x,h as m,i as t,H as Ue,f as u,a2 as De,S as Be,a3 as Ce,a4 as Fe,$ as Te,Y as _,a5 as Oe,a6 as ze,a7 as j,q as we,a1 as Me,z as $}from"./index-c88bb001.js";const Se={class:"body"},xe={class:"field-input"},_e={key:0,class:"field-toggle"},je={key:0,class:"actions"},$e={__name:"DataForm",props:{modelValue:{type:Object,default(){return{}}},fieldsLayout:{type:Array,default(){return[]}},dataFields:{type:Array,default(){return[]}},schemas:{type:Array,default(){return[]}},errorMessages:{type:Object,default(){return{}}},compact:{type:Boolean,default:!1},submittable:{type:Boolean,default:!0},confirmButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-check",value:"Confirm"}}},cancelButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-xmark",value:"Cancel"}}}},emits:["update:modelValue","submit","cancel"],setup(y,{emit:O}){const V=y,{schemasMap:k,serverOptionsKeys:I,inputType:p,inputLabel:l,inputableField:L,multiInputableField:E,multiSelectableField:U,singleSelectableField:A,nullToggleableField:D,nullToggleableKeys:H,objectField:N,fileField:P,formatInputOptionsData:K,fetchOptions:R,initOptionsData:q}=ge(V.schemas),J=he(),Y=ye(),B=w(H.value.reduce((a,r)=>(a[r]=!1,a),{}));function i(a){return!D(a)||B.value[a]}function G(a){return i(a)&&L(a)}function Q(a){return i(a)&&P(a)}function W(a){return i(a)&&(E(a)||N(a))}function X(a){return i(a)&&p(a)==="date"}function Z(a){return i(a)&&p(a)==="datetime"}function f(a){return i(a)&&(p(a)==="enum"||p(a)==="select")}function ee(a){return i(a)&&p(a)==="daterange"}function ae(a){return i(a)&&p(a)==="datetimerange"}function te(a){return i(a)&&p(a)==="boolean"}function d(a){return V.dataFields.find(r=>r===a)}function ne(a){return`Has ${l(a)}`}function oe(a){return(p(a)==="select"||p(a)==="enum")&&k.value[a].options.length>30}function b(a){return!V.errorMessages||!V.errorMessages[a]?"":V.errorMessages[a].map(r=>Y[r.name](r.params)).join(", ")}const C=w({});function g(a){return C.value[a]}function se(a){return i(a)&&A(a)&&!!g(a)}function re(a){return i(a)&&U(a)&&!!g(a)}const z=v(()=>I.value.reduce((a,r)=>(a[r]=c=>{ue(r,c)},a),{}));async function ue(a,r){const c=k.value[a].limit||5;await R(a,r).then(F=>{C.value[a]=K(a,r,c,F)})}const n=v(()=>V.modelValue),le=v(()=>V.compact?"form compact":"form");function me(a){return D(a)?"data-field toggleable":"data-field"}const ce=v(()=>V.confirmButton),pe=v(()=>V.cancelButton);function ie(){O("submit",n.value)}function de(){O("cancel")}return ve(async()=>{await q().then(a=>{C.value=a}).catch(a=>{J.error("Error initializing options data",a)})}),(a,r)=>(s(),h("div",{class:x(t(le))},[T("div",Se,[(s(!0),h(M,null,S(y.fieldsLayout,(c,F)=>(s(),h("div",{key:F,class:"data-row"},[(s(!0),h(M,null,S(Object.keys(c),(e,be)=>ke(a.$slots,`form-col.${e}`,Me({key:be},{field:e,type:t(p)(e),label:t(l)(e)}),()=>[T("div",{class:x(me(e))},[T("div",xe,[G(e)?(s(),m(t(Ue),{key:0,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,type:t(p)(e),label:t(l)(e),size:c[e],disabled:!d(e),"error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","type","label","size","disabled","error-message"])):u("",!0),Q(e)?(s(),m(t(De),{key:1,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),size:c[e],disabled:!d(e),"error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","size","disabled","error-message"])):u("",!0),W(e)?(s(),m(t(Be),{key:2,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!d(e),"error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0),X(e)?(s(),m(t(Ce),{key:3,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!d(e),"align-pickers":"top","error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0),Z(e)?(s(),m(t(Fe),{key:4,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!d(e),"display-time":!0,"align-pickers":"top","error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0),f(e)?(s(),m(t(Te),{key:5,id:e,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),name:e,options:t(k)[e].options,size:c[e],disabled:!d(e),searchable:oe(e),"error-message":b(e)},null,8,["id","modelValue","onUpdate:modelValue","label","name","options","size","disabled","searchable","error-message"])):u("",!0),se(e)?(s(),m(t(_),{key:6,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),name:e,multiple:t(U)(e),options:g(e).data,"options-length":g(e).total,"options-loading":g(e).loading,pagination:g(e).pagination,size:c[e],disabled:!d(e),"error-message":b(e),onOffsetChange:t(z)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","multiple","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):u("",!0),re(e)?(s(),m(t(_),{key:7,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),name:e,multiple:t(U)(e),options:g(e).data,"options-length":g(e).total,"options-loading":g(e).loading,pagination:g(e).pagination,size:c[e],disabled:!d(e),"error-message":b(e),onOffsetChange:t(z)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","multiple","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):u("",!0),ee(e)&&t(n)[e]?(s(),m(t(Oe),{key:8,"start-date":t(n)[e].startDate,"onUpdate:startDate":o=>t(n)[e].startDate=o,"end-date":t(n)[e].endDate,"onUpdate:endDate":o=>t(n)[e].endDate=o,label:t(l)(e),disabled:!d(e),"error-message":b(e)},null,8,["start-date","onUpdate:startDate","end-date","onUpdate:endDate","label","disabled","error-message"])):u("",!0),ae(e)&&t(n)[e]?(s(),m(t(ze),{key:9,"start-time":t(n)[e].startTime,"onUpdate:startTime":o=>t(n)[e].startTime=o,"end-time":t(n)[e].endTime,"onUpdate:endTime":o=>t(n)[e].endTime=o,label:t(l)(e),disabled:!d(e),"error-message":b(e)},null,8,["start-time","onUpdate:startTime","end-time","onUpdate:endTime","label","disabled","error-message"])):u("",!0),te(e)?(s(),m(t(j),{key:10,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!d(e),"error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0)]),t(D)(e)?(s(),h("div",_e,[we(t(j),{modelValue:B.value[e],"onUpdate:modelValue":o=>B.value[e]=o,label:ne(e)},null,8,["modelValue","onUpdate:modelValue","label"])])):u("",!0)],2)],!0)),128))]))),128))]),y.submittable?(s(),h("div",je,[t(ce)?(s(),m(t($),{key:0,class:"button","button-type":y.confirmButton.type,value:y.confirmButton.value,icon:y.confirmButton.icon,onClick:r[0]||(r[0]=c=>ie())},null,8,["button-type","value","icon"])):u("",!0),t(pe)?(s(),m(t($),{key:1,class:"button","button-type":y.cancelButton.type,value:y.cancelButton.value,icon:y.cancelButton.icon,onClick:r[1]||(r[1]=c=>de())},null,8,["button-type","value","icon"])):u("",!0)])):u("",!0)],2))}},Ae=Ve($e,[["__scopeId","data-v-8b7cca1c"]]);export{Ae as D};

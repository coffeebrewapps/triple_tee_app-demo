import{D as L}from"./DataPage-b21f61a6.js";import{q as R,u as U,i as q,D as H,a as M,c as p,r as y,b as u,d as h,m as $,t as c,x as l,v as a,e as I,l as v,h as o,g as j,E as z}from"./index-affc3919.js";import{u as G}from"./utils-6b0a5e47.js";import"./input-4a95c407.js";import"./errors-ebd9927f.js";import"./DataForm-d1d7fb39.js";const J={class:"page-container"},K={key:0,class:"tag inline"},ee={__name:"InvoicesPage",props:{contactId:{type:String,default:null}},setup(V){const r=V,f=R(),D=U(),{flashMessage:m}=q(),w=H(),x=M(),{fieldsLayout:b,generateDataFields:C,validations:N,generateFilters:_}=G(),k=p(()=>C(r.contactId)),S=p(()=>_(r.contactId)),E={view:{click:async function(e,s){await A(e)}},create:{click:async function(){await B()}},row:{void:{name:"Void",icon:"fa-solid fa-ban",click:async function(e,s){await P(e)}}}},F={oneline:!0,showHeader:!1,highlightField:"invoiceNumber"};async function A(e){f.push({name:"Contact View Invoice",params:{invoiceId:e.id,contactId:e.contactId}})}async function B(){f.push({name:"Contact Create Invoice",params:{contactId:r.contactId}})}const n=y(),i=y(!1);async function P(e){n.value=e,i.value=!0}async function T(){await D.update("invoices",n.value.id,{},{path:"void"}).then(e=>{w.emitEvent("loadData",{dataType:"Invoices"}),m("Voided invoice successfully!")}).catch(e=>{x.error("Error voiding invoice",e),m("Error voiding invoice!")}).finally(()=>{g()})}function g(){i.value=!1}return(e,s)=>(u(),h("div",J,[$(L,{"model-class":"invoices","data-type":"Invoices",fullscreen:!0,"fields-layout":o(b),"data-fields":o(k),validations:o(N),filters:o(S),actions:E,"table-style":F},{["highlight.invoiceNumber"]:c(({row:t,formattedValue:d})=>[l(" Invoice Number "+a(d.toString().padStart(6,"0"))+" ",1),t.voided?(u(),h("span",K,"Voided")):I("",!0)]),["data-col.invoiceDate"]:c(({formattedValue:t})=>[l(" Invoiced on "),v("strong",null,a(t),1)]),["data-col.dueDate"]:c(({formattedValue:t})=>[l(" Due on "),v("strong",null,a(t),1)]),["data-col.totalAmount"]:c(({row:t,formattedValue:d})=>[l(" Total "),v("strong",null,a(t.includes.currencyId[t.currencyId].code)+a(d.toFixed(2)),1)]),_:2},1032,["fields-layout","data-fields","validations","filters"]),n.value?(u(),j(o(z),{key:0,modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=t=>i.value=t),title:"Void Invoice","primary-text":"Are you sure you want to void this invoice?","secondary-text":`Invoice Number ${n.value.invoiceNumber}`,width:500,height:350,class:"void-dialog",onConfirm:T,onCancel:g},null,8,["modelValue","secondary-text"])):I("",!0)]))}};export{ee as default};

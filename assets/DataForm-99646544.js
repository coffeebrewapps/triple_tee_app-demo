import{u as be}from"./input-96deff6b.js";import{u as ge}from"./errors-ebd9927f.js";import{_ as ve,k as ye,r as O,c as M,o as Ve,d as l,e as V,n as T,F as S,g as x,M as he,J as j,h as b,i as t,H as ke,f as r,a2 as Ue,S as De,a3 as Fe,a4 as Ce,$ as Oe,Y as _,a5 as Te,a6 as ze,a7 as $,q as z,a1 as Be,z as I}from"./index-28e5efc2.js";const we={class:"body"},Me={class:"field-input"},Se={key:0,class:"field-toggle"},xe={key:0,class:"actions"},je={__name:"DataForm",props:{modelValue:{type:Object,default(){return{}}},fieldsLayout:{type:Array,default(){return[]}},dataFields:{type:Array,default(){return[]}},schemas:{type:Array,default(){return[]}},errorMessages:{type:Object,default(){return{}}},compact:{type:Boolean,default:!1},submittable:{type:Boolean,default:!0},confirmButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-check",value:"Confirm"}}},cancelButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-xmark",value:"Cancel"}}}},emits:["update:modelValue","submit","cancel"],setup(v,{emit:B}){const y=v,{schemasMap:h,serverOptionsKeys:L,inputType:c,inputLabel:u,inputableField:E,multiInputableField:A,multiSelectableField:k,singleSelectableField:H,nullToggleableField:U,nullToggleableKeys:N,objectField:P,fileField:K,formatInputOptionsData:R,fetchOptions:q,initOptionsData:J}=be(y.schemas),Y=ye(),G=ge(),D=O(N.value.reduce((a,s)=>(a[s]=!1,a),{}));function p(a){return!U(a)||D.value[a]}function Q(a){return p(a)&&E(a)}function W(a){return p(a)&&K(a)}function X(a){return p(a)&&(A(a)||P(a))}function Z(a){return p(a)&&c(a)==="date"}function f(a){return p(a)&&c(a)==="datetime"}function ee(a){return p(a)&&(c(a)==="enum"||c(a)==="select")}function ae(a){return p(a)&&c(a)==="daterange"}function te(a){return p(a)&&c(a)==="datetimerange"}function ne(a){return p(a)&&c(a)==="boolean"}function i(a){return y.dataFields.find(s=>s===a)}function oe(a){return`Has ${u(a)}`}function se(a){return(c(a)==="select"||c(a)==="enum")&&h.value[a].options.length>30}function d(a){return!y.errorMessages||!y.errorMessages[a]?"":y.errorMessages[a].map(s=>G[s.name](s.params)).join(", ")}const F=O({});function g(a){return F.value[a]}function le(a){return p(a)&&H(a)&&!!g(a)}function ue(a){return p(a)&&k(a)&&!!g(a)}const w=M(()=>L.value.reduce((a,s)=>(a[s]=m=>{re(s,m)},a),{}));async function re(a,s){const m=h.value[a].limit||5;await q(a,s).then(C=>{F.value[a]=R(a,s,m,C)})}const n=O({}),me=M(()=>y.compact?"form compact":"form");function ce(a){return U(a)?"data-field toggleable":"data-field"}function pe(){B("submit",n.value)}function ie(){B("cancel")}return Ve(async()=>{n.value=Object.assign({},y.modelValue),await J().then(a=>{F.value=a}).catch(a=>{Y.error("Error initializing options data",a)})}),(a,s)=>(l(),V("div",{class:j(t(me))},[T("div",we,[(l(!0),V(S,null,x(v.fieldsLayout,(m,C)=>(l(),V("div",{key:C,class:"data-row"},[(l(!0),V(S,null,x(Object.keys(m),(e,de)=>he(a.$slots,`form-col.${e}`,Be({key:de},{field:e,type:t(c)(e),label:t(u)(e)}),()=>[T("div",{class:j(ce(e))},[T("div",Me,[Q(e)?(l(),b(t(ke),{key:0,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,type:t(c)(e),label:t(u)(e),size:m[e],disabled:!i(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","type","label","size","disabled","error-message"])):r("",!0),W(e)?(l(),b(t(Ue),{key:1,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(u)(e),size:m[e],disabled:!i(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","size","disabled","error-message"])):r("",!0),X(e)?(l(),b(t(De),{key:2,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(u)(e),disabled:!i(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):r("",!0),Z(e)?(l(),b(t(Fe),{key:3,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(u)(e),disabled:!i(e),"align-pickers":"top","error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):r("",!0),f(e)?(l(),b(t(Ce),{key:4,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(u)(e),disabled:!i(e),"display-time":!0,"align-pickers":"top","error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):r("",!0),ee(e)?(l(),b(t(Oe),{key:5,id:e,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(u)(e),name:e,options:t(h)[e].options,size:m[e],disabled:!i(e),searchable:se(e),"error-message":d(e)},null,8,["id","modelValue","onUpdate:modelValue","label","name","options","size","disabled","searchable","error-message"])):r("",!0),le(e)?(l(),b(t(_),{key:6,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(u)(e),name:e,multiple:t(k)(e),options:g(e).data,"options-length":g(e).total,"options-loading":g(e).loading,pagination:g(e).pagination,size:m[e],disabled:!i(e),"error-message":d(e),onOffsetChange:t(w)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","multiple","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):r("",!0),ue(e)?(l(),b(t(_),{key:7,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(u)(e),name:e,multiple:t(k)(e),options:g(e).data,"options-length":g(e).total,"options-loading":g(e).loading,pagination:g(e).pagination,size:m[e],disabled:!i(e),"error-message":d(e),onOffsetChange:t(w)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","multiple","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):r("",!0),ae(e)&&n.value[e]?(l(),b(t(Te),{key:8,"start-date":n.value[e].startDate,"onUpdate:startDate":o=>n.value[e].startDate=o,"end-date":n.value[e].endDate,"onUpdate:endDate":o=>n.value[e].endDate=o,label:t(u)(e),disabled:!i(e),"error-message":d(e)},null,8,["start-date","onUpdate:startDate","end-date","onUpdate:endDate","label","disabled","error-message"])):r("",!0),te(e)&&n.value[e]?(l(),b(t(ze),{key:9,"start-time":n.value[e].startTime,"onUpdate:startTime":o=>n.value[e].startTime=o,"end-time":n.value[e].endTime,"onUpdate:endTime":o=>n.value[e].endTime=o,label:t(u)(e),disabled:!i(e),"error-message":d(e)},null,8,["start-time","onUpdate:startTime","end-time","onUpdate:endTime","label","disabled","error-message"])):r("",!0),ne(e)?(l(),b(t($),{key:10,modelValue:n.value[e],"onUpdate:modelValue":o=>n.value[e]=o,label:t(u)(e),disabled:!i(e),"error-message":d(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):r("",!0)]),t(U)(e)?(l(),V("div",Se,[z(t($),{modelValue:D.value[e],"onUpdate:modelValue":o=>D.value[e]=o,label:oe(e)},null,8,["modelValue","onUpdate:modelValue","label"])])):r("",!0)],2)],!0)),128))]))),128))]),v.submittable?(l(),V("div",xe,[z(t(I),{class:"button","button-type":v.confirmButton.type,value:v.confirmButton.value,icon:v.confirmButton.icon,onClick:s[0]||(s[0]=m=>pe())},null,8,["button-type","value","icon"]),z(t(I),{class:"button","button-type":v.cancelButton.type,value:v.cancelButton.value,icon:v.cancelButton.icon,onClick:s[1]||(s[1]=m=>ie())},null,8,["button-type","value","icon"])])):r("",!0)],2))}},Le=ve(je,[["__scopeId","data-v-b50ff311"]]);export{Le as D};

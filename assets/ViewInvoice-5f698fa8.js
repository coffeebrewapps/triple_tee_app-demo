import{u as Y}from"./input-0d8e93b0.js";import{v as U,d as E,o as a,g as y,h as n,_ as z,a as G,A as J,u as Q,n as R,b as W,r as v,e as X,c as o,B as Z,f as u,q as S,F as q,x as A,k as M,t as O}from"./index-c658bd47.js";import{u as ee}from"./utils-87e74dec.js";import{T as te}from"./TabContainer-ad097b63.js";import{D as ae}from"./DataPage-acfba081.js";import{T as ne}from"./TemplateEditor-5412f14b.js";import"./errors-29306128.js";import"./DataForm-115dae47.js";const ie={__name:"InvoiceLines",props:{invoiceId:{type:String,default:null}},setup(m){const p=m,{greaterThanOrEqual:l}=U(),f=[{description:"lg"},{unit:"md",unitCost:"md",subtotal:"md"},{invoiceId:"lg"}],g=E(()=>[{key:"id",type:"text",label:"ID",listable:!0,viewable:!0,creatable:!1,updatable:!1,sortable:!0},{key:"description",type:"text",label:"Description",listable:!0,viewable:!0,creatable:!0,updatable:!0,filterable:!0},{key:"unit",type:"enum",label:"Unit",listable:!1,viewable:!0,creatable:!0,updatable:!0},{key:"unitCost",type:"number",label:"Unit Cost",listable:!1,viewable:!0,creatable:!0,updatable:!0},{key:"subtotal",type:"number",label:"Subtotal",listable:!0,viewable:!0,creatable:!0,updatable:!0},{key:"invoiceId",type:"singleSelect",label:"Invoice",reference:{label:s},listable:!1,viewable:!0,creatable:!0,updatable:!1,filterable:!0,options:{server:!0,pagination:!0,modelClass:"invoices",value:k,label:s}}]);function k(e){return e.id}function s(e){return`Invoice #${e.invoiceNumber}`}const h={create:{unitCost:[e=>l(e,"unitCost",0)],subtotal:[e=>l(e,"subtotal",0)]},update:{unitCost:[e=>l(e,"unitCost",0)],subtotal:[e=>l(e,"subtotal",0)]}},_=E(()=>{const e={};return p.invoiceId&&(e.invoiceId=[{value:p.invoiceId}]),e.description=null,{initData:e,layout:[{invoiceId:"lg",description:"lg"}]}});return(e,T)=>(a(),y(ae,{"model-class":"invoice_lines","data-type":"Invoice Lines","fields-layout":f,"data-fields":n(g),validations:h,filters:n(_)},null,8,["data-fields","filters"]))}};const oe={class:"page-container"},le={key:0,class:"details-container"},se={class:"field-label"},ce={class:"field-value"},ue={key:0},re={key:1},de={__name:"ViewInvoice",props:{contactId:{type:String,default:null},invoiceId:{type:String,default:null}},setup(m){const p=m,l=G(),{isEmpty:f,notEmpty:g}=U(),k=J(),{flashMessage:s}=Q(),h=R(),_=W(),{fieldsLayout:e,generateDataFields:T}=ee(),x=E(()=>T(p.contactId)),{inputLabel:j,inputValue:P,includeKeys:V}=Y(x.value),i=v(),C=v(),w=v(),r=v(),B=v();async function F(){i.value=null;const t={include:V.value};await l.view("invoices",p.invoiceId,t).then(d=>{i.value=d,s("Loaded invoice successfully!")}).catch(d=>{_.error("Error loading invoice",d),s("Error loading invoice!")})}async function $(){C.value=null,w.value=null,r.value=null,l.view("invoices",i.value.id,{},{path:"template_data"}).then(t=>{C.value=t.invoiceLines,w.value=t.invoiceConfig,r.value=t.invoiceTemplate;const d=t.invoiceNumberSequence,L=t.currency,D=t.billingContact,c=t.country,I=t.logo;B.value={invoice:i.value,invoiceLines:C.value,invoiceConfig:w.value,invoiceNumberSequence:d,billingContact:Object.assign({},D,{country:c.countryName,logo:I.rawData}),currency:L,country:c,logo:I},s("Loaded template data successfully!")}).catch(t=>{_.error("Error loading template data",t),s("Error loading template data!")})}const b=v(0),N=[{label:"Details",onchange:F},{label:"Invoice Lines",onchange:H},{label:"View Invoice PDF",onchange:$}];async function H(){k.emitEvent("loadData",{dataType:"Invoice Lines"})}async function K(t){await N[t].onchange(),b.value=t}return X(async()=>{await F()}),(t,d)=>(a(),o("div",oe,[i.value?u("",!0):(a(),y(n(Z),{key:0})),i.value?(a(),y(te,{key:1,"selected-tab":b.value,tabs:N,onTabChange:K},{"tab-0":S(()=>[b.value===0?(a(),o("div",le,[(a(!0),o(q,null,A(n(e),(L,D)=>(a(),o("div",{key:D,class:"data-row"},[(a(!0),o(q,null,A(Object.keys(L),(c,I)=>(a(),o("div",{key:I,class:"data-field"},[M("div",se,O(n(j)(c)),1),M("div",ce,[n(g)(i.value)&&n(g)(i.value[c])?(a(),o("span",ue,O(n(P)(c,i.value,n(V),n(x),n(h))),1)):u("",!0),n(f)(i.value)||n(f)(i.value[c])?(a(),o("span",re," --- no value --- ")):u("",!0)])]))),128))]))),128))])):u("",!0)]),"tab-1":S(()=>[b.value===1?(a(),y(ie,{key:0,"invoice-id":m.invoiceId},null,8,["invoice-id"])):u("",!0)]),"tab-2":S(()=>[b.value===2&&r.value?(a(),y(ne,{key:0,id:r.value.id,"template-type":"invoice_templates","content-markup":r.value.contentMarkup,"content-styles":r.value.contentStyles,data:B.value,disabled:!0},null,8,["id","content-markup","content-styles","data"])):u("",!0)]),_:1},8,["selected-tab"])):u("",!0)]))}},Ie=z(de,[["__scopeId","data-v-7c443302"]]);export{Ie as default};

import{u as be}from"./input-4a95c407.js";import{u as ge}from"./errors-ebd9927f.js";import{_ as ye,r as w,c as v,o as Ve,b as s,d as h,l as T,F as S,f as x,L as he,I as M,g as m,h as t,G as ve,e as u,a2 as ke,S as Ue,a3 as De,a4 as Be,$ as Ce,Y as _,a5 as Fe,a6 as Te,a7 as j,m as Oe,a1 as ze,z as I}from"./index-affc3919.js";const we={class:"body"},Se={class:"field-input"},xe={key:0,class:"field-toggle"},Me={key:0,class:"actions"},_e={__name:"DataForm",props:{modelValue:{type:Object,default(){return{}}},fieldsLayout:{type:Array,default(){return[]}},dataFields:{type:Array,default(){return[]}},schemas:{type:Array,default(){return[]}},errorMessages:{type:Object,default(){return{}}},compact:{type:Boolean,default:!1},submittable:{type:Boolean,default:!0},confirmButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-check",value:"Confirm"}}},cancelButton:{type:Object,default(){return{type:"text",icon:"fa-solid fa-xmark",value:"Cancel"}}}},emits:["update:modelValue","submit","cancel"],setup(y,{emit:O}){const V=y,{schemasMap:k,serverOptionsKeys:$,inputType:p,inputLabel:l,inputableField:L,multiInputableField:A,multiSelectableField:U,singleSelectableField:E,nullToggleableField:D,nullToggleableKeys:N,objectField:P,fileField:H,formatInputOptionsData:K,fetchOptions:R,initOptionsData:G}=be(V.schemas),Y=ge(),B=w(N.value.reduce((a,r)=>(a[r]=!1,a),{}));function d(a){return!D(a)||B.value[a]}function q(a){return d(a)&&L(a)}function J(a){return d(a)&&H(a)}function Q(a){return d(a)&&(A(a)||P(a))}function W(a){return d(a)&&p(a)==="date"}function X(a){return d(a)&&p(a)==="datetime"}function Z(a){return d(a)&&(p(a)==="enum"||p(a)==="select")}function f(a){return d(a)&&p(a)==="daterange"}function ee(a){return d(a)&&p(a)==="datetimerange"}function ae(a){return d(a)&&p(a)==="boolean"}function i(a){return V.dataFields.find(r=>r===a)}function te(a){return`Has ${l(a)}`}function ne(a){return(p(a)==="select"||p(a)==="enum")&&k.value[a].options.length>30}function b(a){return V.errorMessages[a]?V.errorMessages[a].map(r=>Y[r.name](r.params)).join(", "):""}const C=w({});function g(a){return C.value[a]}function oe(a){return d(a)&&E(a)&&!!g(a)}function se(a){return d(a)&&U(a)&&!!g(a)}const z=v(()=>$.value.reduce((a,r)=>(a[r]=c=>{re(r,c)},a),{}));async function re(a,r){const c=k.value[a].limit||5;await R(a,r).then(F=>{C.value[a]=K(a,r,c,F)})}const n=v(()=>V.modelValue),ue=v(()=>V.compact?"form compact":"form");function le(a){return D(a)?"data-field toggleable":"data-field"}const me=v(()=>V.confirmButton),ce=v(()=>V.cancelButton);function pe(){O("submit",n.value)}function de(){O("cancel")}return Ve(async()=>{await G().then(a=>{C.value=a})}),(a,r)=>(s(),h("div",{class:M(t(ue))},[T("div",we,[(s(!0),h(S,null,x(y.fieldsLayout,(c,F)=>(s(),h("div",{key:F,class:"data-row"},[(s(!0),h(S,null,x(Object.keys(c),(e,ie)=>he(a.$slots,`form-col.${e}`,ze({key:ie},{field:e,type:t(p)(e),label:t(l)(e)}),()=>[T("div",{class:M(le(e))},[T("div",Se,[q(e)?(s(),m(t(ve),{key:0,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,type:t(p)(e),label:t(l)(e),size:c[e],disabled:!i(e),"error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","type","label","size","disabled","error-message"])):u("",!0),J(e)?(s(),m(t(ke),{key:1,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),size:c[e],disabled:!i(e),"error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","size","disabled","error-message"])):u("",!0),Q(e)?(s(),m(t(Ue),{key:2,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!i(e),"error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0),W(e)?(s(),m(t(De),{key:3,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!i(e),"align-pickers":"top","error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0),X(e)?(s(),m(t(Be),{key:4,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!i(e),"display-time":!0,"align-pickers":"top","error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0),Z(e)?(s(),m(t(Ce),{key:5,id:e,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),name:e,options:t(k)[e].options,size:c[e],disabled:!i(e),searchable:ne(e),"error-message":b(e)},null,8,["id","modelValue","onUpdate:modelValue","label","name","options","size","disabled","searchable","error-message"])):u("",!0),oe(e)?(s(),m(t(_),{key:6,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),name:e,multiple:t(U)(e),options:g(e).data,"options-length":g(e).total,"options-loading":g(e).loading,pagination:g(e).pagination,size:c[e],disabled:!i(e),"error-message":b(e),onOffsetChange:t(z)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","multiple","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):u("",!0),se(e)?(s(),m(t(_),{key:7,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),name:e,multiple:t(U)(e),options:g(e).data,"options-length":g(e).total,"options-loading":g(e).loading,pagination:g(e).pagination,size:c[e],disabled:!i(e),"error-message":b(e),onOffsetChange:t(z)[e]},null,8,["modelValue","onUpdate:modelValue","label","name","multiple","options","options-length","options-loading","pagination","size","disabled","error-message","onOffsetChange"])):u("",!0),f(e)&&t(n)[e]?(s(),m(t(Fe),{key:8,"start-date":t(n)[e].startDate,"onUpdate:startDate":o=>t(n)[e].startDate=o,"end-date":t(n)[e].endDate,"onUpdate:endDate":o=>t(n)[e].endDate=o,label:t(l)(e),disabled:!i(e),"error-message":b(e)},null,8,["start-date","onUpdate:startDate","end-date","onUpdate:endDate","label","disabled","error-message"])):u("",!0),ee(e)&&t(n)[e]?(s(),m(t(Te),{key:9,"start-time":t(n)[e].startTime,"onUpdate:startTime":o=>t(n)[e].startTime=o,"end-time":t(n)[e].endTime,"onUpdate:endTime":o=>t(n)[e].endTime=o,label:t(l)(e),disabled:!i(e),"error-message":b(e)},null,8,["start-time","onUpdate:startTime","end-time","onUpdate:endTime","label","disabled","error-message"])):u("",!0),ae(e)?(s(),m(t(j),{key:10,modelValue:t(n)[e],"onUpdate:modelValue":o=>t(n)[e]=o,label:t(l)(e),disabled:!i(e),"error-message":b(e)},null,8,["modelValue","onUpdate:modelValue","label","disabled","error-message"])):u("",!0)]),t(D)(e)?(s(),h("div",xe,[Oe(t(j),{modelValue:B.value[e],"onUpdate:modelValue":o=>B.value[e]=o,label:te(e)},null,8,["modelValue","onUpdate:modelValue","label"])])):u("",!0)],2)],!0)),128))]))),128))]),y.submittable?(s(),h("div",Me,[t(me)?(s(),m(t(I),{key:0,class:"button","button-type":y.confirmButton.type,value:y.confirmButton.value,icon:y.confirmButton.icon,onClick:r[0]||(r[0]=c=>pe())},null,8,["button-type","value","icon"])):u("",!0),t(ce)?(s(),m(t(I),{key:1,class:"button","button-type":y.cancelButton.type,value:y.cancelButton.value,icon:y.cancelButton.icon,onClick:r[1]||(r[1]=c=>de())},null,8,["button-type","value","icon"])):u("",!0)])):u("",!0)],2))}},Le=ye(_e,[["__scopeId","data-v-ec885854"]]);export{Le as D};

import{_ as b,u as w,a as B,r as p,c as E,o as L,b as T,d as o,e as i,f as d,F as A,g as O,h as m,i as g,C as S,T as D}from"./index-28e5efc2.js";const P={class:"page-container"},U={key:0},H={key:1,class:"charts"},F={__name:"HomeView",setup(N){const y=w(),_=B(),n=p([]),f=p(getComputedStyle(document.documentElement).getPropertyValue("--color-text")),C=p(getComputedStyle(document.documentElement).getPropertyValue("--color-border")),v=E(()=>({highlightColor:f.value,lineColor:C.value}));_.registerListener("themeChange",{id:"RefreshChartColors",invoke:({newVal:a})=>{x()}});function x(){n.value.forEach(a=>{a.config.colors=v.value})}function u(a){return`${a[0].toUpperCase()}${a.slice(1)}`}async function V(){await y.list("chart_configs",{}).then(a=>{const s=a.data.sort((r,e)=>r.displayOrder<e.displayOrder?-1:r.displayOrder>e.displayOrder?1:0).map(r=>new Promise((e,l)=>{y.view("chart_configs",r.id,{},{path:"data"}).then(t=>{e({config:r,result:t})}).catch(t=>{l(t)})}));Promise.all(s).then(r=>{n.value=[],r.forEach(({config:e,result:l})=>{if(l.length===0)return;const t={title:e.description},h=[];e.chartType==="vbar"?(t.yScale=e.scaleValue,t.yAxisLabel=u(e.scaleUnit),t.xAxisLabel=u(e.groupBy),l.forEach(c=>{h.push({xValue:c.key,yValue:c.total})})):(t.xScale=e.scaleValue,t.xAxisLabel=u(e.scaleUnit),t.yAxisLabel=u(e.groupBy),l.forEach(c=>{h.push({yValue:c.key,xValue:c.total})})),n.value.push({chartType:e.chartType,config:t,data:h})})})}).catch(a=>{console.error(a)})}return L(async()=>{await V()}),T(()=>{_.unregisterListener("themeChange",{id:"RefreshChartColors"})}),(a,k)=>(o(),i("div",P,[n.value.length===0?(o(),i("div",U," No chart data. ")):d("",!0),n.value.length>0?(o(),i("div",H,[(o(!0),i(A,null,O(n.value,(s,r)=>(o(),i("div",{key:r,class:"chart"},[s.chartType==="vbar"&&s.data.length>0?(o(),m(g(S),{key:0,config:s.config,data:s.data},null,8,["config","data"])):d("",!0),s.chartType==="hbar"&&s.data.length>0?(o(),m(g(D),{key:1,config:s.config,data:s.data},null,8,["config","data"])):d("",!0)]))),128))])):d("",!0)]))}},$=b(F,[["__scopeId","data-v-169408b3"]]);export{$ as default};

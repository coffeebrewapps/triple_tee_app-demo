import{_ as ue,q as ce,u as pe,y as ve,a as fe,P as me,r as t,c as m,o as _e,b as k,d as he,l as a,m as _,t as h,I as w,h as i,S as R,g as x,x as be,v as I,Q as ge,e as N,z as ye,H as ke,Z as we,R as Se,p as Ee,k as Ce}from"./index-affc3919.js";import{T as Te}from"./TabContainer-da289d4d.js";const r=o=>(Ee("data-v-cc7e28e5"),o=o(),Ce(),o),De={class:"preview-template"},Me={class:"template-editor"},Ve=r(()=>a("i",{class:"fa-solid fa-xmark"},null,-1)),Pe=[Ve],Re=r(()=>a("i",{class:"fa-solid fa-pencil"},null,-1)),xe=[Re],Ne=r(()=>a("i",{class:"fa-solid fa-check"},null,-1)),Le=[Ne],je=r(()=>a("i",{class:"fa-solid fa-xmark"},null,-1)),Be=[je],Oe=r(()=>a("i",{class:"fa-solid fa-pencil"},null,-1)),Ie=[Oe],Ue=r(()=>a("i",{class:"fa-solid fa-check"},null,-1)),Ge=[Ue],Ae=r(()=>a("i",{class:"fa-solid fa-xmark"},null,-1)),Fe=[Ae],qe=r(()=>a("i",{class:"fa-solid fa-pencil"},null,-1)),ze=[qe],He=r(()=>a("i",{class:"fa-solid fa-check"},null,-1)),Je=[He],Ze={class:"preview-container"},$e=r(()=>a("h3",{class:"heading"}," Preview ",-1)),Qe=["innerHTML"],Ke={class:"buttons"},We={class:"message"},Xe={__name:"TemplateEditor",props:{id:{type:String,default:null},contentMarkup:{type:String,default:""},contentStyles:{type:String,default:""},disabled:{type:Boolean,default:!1},data:{type:Object,default(){return{}}},errorMessages:{type:Object,default(){return{}}},enableGenerate:{type:Boolean,default:!0},templateType:{type:String,default:null}},emits:["contentMarkupChange","contentStylesChange","dataChange"],setup(o,{emit:S}){const n=o,E=ce(),U=pe(),{notEmpty:L}=ve(),b=fe(),G=new me,A=t("style"),g=t(n.contentMarkup),C=t(n.contentStyles),j=t(0),F=[{label:"Markup"},{label:"Styles"},{label:"Data"}];function q(e){j.value=e}const d=t(!1),c=t(!1),p=t(!1),z=m(()=>{const e=[];return e.push("editor"),d.value&&e.push("editable"),n.disabled&&e.push("disabled"),e.join(" ")}),H=m(()=>{const e=[];return e.push("editor"),c.value&&e.push("editable"),n.disabled&&e.push("disabled"),e.join(" ")}),J=m(()=>{const e=[];return e.push("editor"),p.value&&e.push("editable"),n.disabled&&e.push("disabled"),e.join(" ")});function Z(){d.value=!0}async function $(){f.value=!1,await D().then(e=>{te()}).catch(e=>{f.value=!0,v.value="Markup error",b.error("Error updating markup",e)}).finally(()=>{d.value=!1})}function Q(){c.value=!0}function K(){le(),c.value=!1}function W(){p.value=!0}async function X(){f.value=!1,await D().then(e=>{se()}).catch(e=>{f.value=!0,v.value="Sample data error",b.error("Error updating sample data",e)}).finally(()=>{p.value=!1})}function Y(){d.value=!d.value}function ee(){c.value=!c.value}function ae(){p.value=!p.value}function te(){S("contentMarkupChange",g.value)}function le(){S("contentStylesChange",C.value)}function se(){S("dataChange",T.value)}const u=t("");function ne(){L(n.data)?u.value=JSON.stringify(n.data,!1,4):u.value=""}const T=m(()=>L(u.value)&&u.value!==""?JSON.parse(u.value):{}),oe=m(()=>f.value?"preview-content error":"preview-content"),v=t(),f=t(!1);async function D(){return new Promise((e,s)=>{v.value=null,G.parseAndRender(g.value,T.value).then(l=>{v.value=l,e(l)}).catch(l=>{s(l)})})}const y=t(!1),M=t(!1),V=t(),P=t(),B=t(),O=t();async function ie(){P.value=null,y.value=!0,M.value=!0,V.value="Generating PDF...",await U.downloadStream(n.templateType,n.id,T.value,{path:"pdf"}).then(e=>{const s=new Blob([e.data],{type:"application/pdf"}),l=window.URL.createObjectURL(s);B.value=l,O.value=`${n.templateType}_${n.id}.pdf`,P.value=l,de(),re()}).catch(e=>{M.value=!1,V.value="Error generating template",b.error("Error generating template",e)})}function re(){const e=Object.assign({},E.currentRoute.value),s={path:"/document_templates/:templateType/:id/pdf",name:"View Pdf",component:()=>Se(()=>import("./PdfViewer-483e887e.js"),["assets/PdfViewer-483e887e.js","assets/index-affc3919.js","assets/index-6fa5053e.css","assets/PdfViewer-16a6273b.css"]),props:{templatePdfData:P.value,downloadLink:B.value,downloadFile:O.value},meta:{parentRoute:{name:e.name},hidden:!0}};E.addRoute(s),E.push({name:"View Pdf",params:{templateType:n.templateType,id:n.id}})}function de(){y.value=!1}return _e(async()=>{ne(),await D().catch(e=>{f.value=!0,v.value="Render error",b.error("Error rendering preview",e)}).finally(()=>{d.value=!1})}),(e,s)=>(k(),he("div",De,[a("div",Me,[_(Te,{"selected-tab":j.value,tabs:F,onTabChange:q},{"tab-0":h(()=>[a("div",{class:w(i(z))},[_(i(R),{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=l=>g.value=l),label:"",rows:30,disabled:!d.value,"error-message":o.errorMessages.contentMarkup},null,8,["modelValue","disabled","error-message"]),a("div",{class:"editor-button cancel",onClick:Y},Pe),a("div",{class:"editor-button edit",onClick:Z},xe),a("div",{class:"editor-button confirm",onClick:$},Le)],2)]),"tab-1":h(()=>[a("div",{class:w(i(H))},[_(i(R),{modelValue:C.value,"onUpdate:modelValue":s[1]||(s[1]=l=>C.value=l),label:"",rows:30,disabled:!c.value,"error-message":o.errorMessages.contentStyles},null,8,["modelValue","disabled","error-message"]),a("div",{class:"editor-button cancel",onClick:ee},Be),a("div",{class:"editor-button edit",onClick:Q},Ie),a("div",{class:"editor-button confirm",onClick:K},Ge)],2)]),"tab-2":h(()=>[a("div",{class:w(i(J))},[_(i(R),{modelValue:u.value,"onUpdate:modelValue":s[2]||(s[2]=l=>u.value=l),label:"",rows:30,disabled:!p.value},null,8,["modelValue","disabled"]),a("div",{class:"editor-button cancel",onClick:ae},Fe),a("div",{class:"editor-button edit",onClick:W},ze),a("div",{class:"editor-button confirm",onClick:X},Je)],2)]),_:1},8,["selected-tab"])]),a("div",Ze,[$e,a("div",{class:w(i(oe)),innerHTML:v.value},null,10,Qe),o.contentStyles?(k(),x(ge(A.value),{key:0},{default:h(()=>[be(I(o.contentStyles),1)]),_:1})):N("",!0),a("div",Ke,[o.enableGenerate?(k(),x(i(ye),{key:0,value:"Generate",icon:"fa-solid fa-file-export",onClick:ie})):N("",!0)])]),_(i(we),{modelValue:y.value,"onUpdate:modelValue":s[3]||(s[3]=l=>y.value=l),class:"generate-dialog",title:"Generating PDF",width:400,height:250},{body:h(()=>[M.value?(k(),x(i(ke),{key:0})):N("",!0),a("div",We,I(V.value),1)]),_:1},8,["modelValue"])]))}},aa=ue(Xe,[["__scopeId","data-v-cc7e28e5"]]);export{aa as T};
